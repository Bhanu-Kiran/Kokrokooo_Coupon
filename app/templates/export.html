{% extends "base.html" %}
{% block title %}Export Coupons{% endblock %}

{% block content %}
<div class="app-container">
  <aside class="sidebar" aria-hidden="true">
    <div class="sidebar-brand">CouponApp</div>
    <nav class="side-nav">
      <a class="nav-item" href="{{ url_for('main.index') }}">Dashboard</a>
      <a class="nav-item" href="{{ url_for('main.register') }}">Register</a>
      <a class="nav-item" href="{{ url_for('main.redeem') }}">Redeem</a>
      <a class="nav-item" href="{{ url_for('main.import_excel') }}">Import</a>
      <a class="nav-item active" href="{{ url_for('main.export') }}">Export</a>
      <a class="nav-item" href="{{ url_for('main.admin') }}">Admin</a>
      <a class="nav-item" href="{{ url_for('main.logs') }}">Logs</a>
    </nav>
  </aside>

  <main class="main">
    <section class="table-card">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <h2>Export Coupons</h2>
        <div>
          <a class="btn" href="{{ url_for('main.export_xlsx') }}">Download as Excel (.xlsx)</a>
        </div>
      </div>

      <p style="margin-top:8px; color:#6b6f74;">All coupons in the database. Use filters later to narrow exports.</p>

      <table class="coupons-table" style="margin-top:12px;">
        <thead>
          <tr>
            <th>Code</th>
            <th>Description</th>
            <th>Issued At</th>
            <th>Valid To</th>
            <th>Status</th>
            <th>Redeemed</th>
            <th>Max</th>
            <th>Tags</th>
          </tr>
        </thead>
        <tbody>
          {% for c in coupons %}
          <tr>
            <td class="mono">{{ c.code }}</td>
            <td>{{ c.description }}</td>
            <td>{{ c.issued_at }}</td>
            <td>{{ c.valid_to }}</td>
            <td><span class="pill pill-{{ c.status|lower|replace(' ', '-') }}">{{ c.status }}</span></td>
            <td>{{ c.redeemed_count }}</td>
            <td>{{ c.max_redemptions }}</td>
            <td>{{ c.tags }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </section>
  </main>
</div>
{% endblock %}
