{% extends "base.html" %}
{% block title %}Import Coupons{% endblock %}

{% block content %}
<div class="app-container">
  <aside class="sidebar" aria-hidden="true">
    <div class="sidebar-brand">CouponApp</div>
    <nav class="side-nav">
      <a class="nav-item" href="{{ url_for('main.index') }}">Dashboard</a>
      <a class="nav-item" href="{{ url_for('main.register') }}">Register</a>
      <a class="nav-item" href="{{ url_for('main.redeem') }}">Redeem</a>
      <a class="nav-item active" href="{{ url_for('main.import_excel') }}">Import</a>
      <a class="nav-item" href="{{ url_for('main.export') }}">Export</a>
      <a class="nav-item" href="{{ url_for('main.admin') }}">Admin</a>
      <a class="nav-item" href="{{ url_for('main.logs') }}">Logs</a>

    </nav>
  </aside>

  <main class="main">
    <header class="main-header">
      <h1 class="title">Import Coupons</h1>
      <div class="header-meta">Upload .xlsx or .csv in the template format.</div>
    </header>

    <section class="table-card" style="max-width:880px;">
      <form method="post" enctype="multipart/form-data" action="{{ url_for('main.import_excel') }}">
        <div style="display:flex; gap:12px; align-items:center;">
          <input type="file" name="file" accept=".csv,.xlsx" required />
          <button class="btn" type="submit">Upload & Import</button>
          <a class="btn ghost" href="{{ url_for('main.export_xlsx') }}">Download Sample Export</a>
        </div>

        <p style="margin-top:12px; color:#6b6f74; font-size:13px;">
          Expected columns (case-insensitive): code, description, issued_at, validity_value, validity_unit, issued_to, tags, max_redemptions
        </p>
      </form>
    </section>

  </main>
</div>
{% endblock %}
